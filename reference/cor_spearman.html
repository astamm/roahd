<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Spearman's correlation coefficient for multivariate functional data — cor_spearman • roahd</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Spearman's correlation coefficient for multivariate functional data — cor_spearman"><meta property="og:description" content="This function computes the Spearman's correlation coefficient for a
multivariate functional dataset, with either a Modified Epigraph Index (MEI)
or Modified Hypograph Index (MHI) ranking of univariate elements of data
components."><meta property="og:image" content="https://astamm.github.io/roahd/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">roahd</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4.3.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/roahd.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/astamm/roahd/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Spearman's correlation coefficient for multivariate functional data</h1>
    <small class="dont-index">Source: <a href="https://github.com/astamm/roahd/blob/HEAD/R/correlation.R" class="external-link"><code>R/correlation.R</code></a></small>
    <div class="hidden name"><code>cor_spearman.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function computes the Spearman's correlation coefficient for a
multivariate functional dataset, with either a Modified Epigraph Index (MEI)
or Modified Hypograph Index (MHI) ranking of univariate elements of data
components.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">cor_spearman</span><span class="op">(</span><span class="va">mfD</span>, ordering <span class="op">=</span> <span class="st">"MEI"</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>mfD</dt>
<dd><p>a multivariate functional dataset whose Spearman's correlation
coefficient must be computed, in form of multivariate <code>mfData</code> object.</p></dd>
<dt>ordering</dt>
<dd><p>the ordering relation to use on functional observations,
either <code>"MEI"</code> for MEI or <code>"MHI"</code> for MHI (default is
<code>"MEI"</code>).</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>If the original dataset is bivariate, the function returns only the
scalar value of the correlation coefficient for the two components. When
the number of components is L &gt;2, it returns the whole matrix of Spearman's
correlation coefficients for all the components.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Given a multivariate functional dataset, with first components \(X^1_1(t),
X^1_2(t), \ldots, X^1_N(t)\), second components \(X^2_1(t), X^2_2(t),
\ldots, X^2_N(t)\), etc., the function exploits either the MEI or MHI to
compute the matrix of Spearman's correlation coefficients. Such matrix is
symmetrical and has ones on the diagonal. The entry (i, j) represents the
Spearman correlation coefficient between curves of component i and j.</p>
<p>See the references for more details.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Valencia, D., Romo, J. and Lillo, R. (2015). Spearman coefficient for
functions, <em>Universidad Carlos III de Madrid technical report</em>,
<code>http://EconPapers.repec.org/RePEc:cte:wsrepe:ws133329</code>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="mfData.html">mfData</a></code>, <code><a href="MEI.html">MEI</a></code>, <code><a href="MHI.html">MHI</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co">#### TOTALLY INDEPENDENT COMPONENTS</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">N</span> <span class="op">=</span> <span class="fl">2e2</span></span>
<span class="r-in"><span class="va">P</span> <span class="op">=</span> <span class="fl">1e3</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">grid</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="va">P</span> <span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Creating an exponential covariance function to simulate guassian data</span></span>
<span class="r-in"><span class="va">Cov</span> <span class="op">=</span> <span class="fu"><a href="exp_cov_function.html">exp_cov_function</a></span><span class="op">(</span> <span class="va">grid</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>, beta <span class="op">=</span> <span class="fl">0.4</span> <span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Simulating (independent) gaussian functional data with given center and</span></span>
<span class="r-in"><span class="co"># covariance function</span></span>
<span class="r-in"><span class="va">Data_1</span> <span class="op">=</span> <span class="fu"><a href="generate_gauss_fdata.html">generate_gauss_fdata</a></span><span class="op">(</span> <span class="va">N</span>, centerline <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">grid</span> <span class="op">)</span>, Cov <span class="op">=</span> <span class="va">Cov</span> <span class="op">)</span></span>
<span class="r-in"><span class="va">Data_2</span> <span class="op">=</span> <span class="fu"><a href="generate_gauss_fdata.html">generate_gauss_fdata</a></span><span class="op">(</span> <span class="va">N</span>, centerline <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">grid</span> <span class="op">)</span>, Cov <span class="op">=</span> <span class="va">Cov</span> <span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Using the simulated data as (independent) components of a bivariate functional</span></span>
<span class="r-in"><span class="co"># dataset</span></span>
<span class="r-in"><span class="va">mfD</span> <span class="op">=</span> <span class="fu"><a href="mfData.html">mfData</a></span><span class="op">(</span> <span class="va">grid</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="va">Data_1</span>, <span class="va">Data_2</span> <span class="op">)</span> <span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Correlation approx. zero (components were created independently)</span></span>
<span class="r-in"><span class="fu">cor_spearman</span><span class="op">(</span> <span class="va">mfD</span>, ordering <span class="op">=</span> <span class="st">'MEI'</span> <span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.01993845</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Correlation approx. zero (components were created independently)</span></span>
<span class="r-in"><span class="fu">cor_spearman</span><span class="op">(</span> <span class="va">mfD</span>, ordering <span class="op">=</span> <span class="st">'MHI'</span> <span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.01993845</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#### TOTALLY DEPENDENT COMPONENTS</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Nonlinear transform of first component</span></span>
<span class="r-in"><span class="va">Data_3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span> <span class="va">Data_1</span>, <span class="fl">1</span>, <span class="va">exp</span> <span class="op">)</span> <span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Creating bivariate dataset starting from nonlinearly-dependent components</span></span>
<span class="r-in"><span class="va">mfD</span> <span class="op">=</span> <span class="fu"><a href="mfData.html">mfData</a></span><span class="op">(</span> <span class="va">grid</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="va">Data_1</span>, <span class="va">Data_3</span> <span class="op">)</span> <span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Correlation very high (components are nonlinearly dependent)</span></span>
<span class="r-in"><span class="fu">cor_spearman</span><span class="op">(</span> <span class="va">mfD</span>, ordering <span class="op">=</span> <span class="st">'MEI'</span> <span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Correlation very high (components are nonlinearly dependent)</span></span>
<span class="r-in"><span class="fu">cor_spearman</span><span class="op">(</span> <span class="va">mfD</span>, ordering <span class="op">=</span> <span class="st">'MHI'</span> <span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Nicholas Tarabelloni, Ana Arribas-Gil, Francesca Ieva, Anna Maria Paganoni, Juan Romo, Aymeric Stamm.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>


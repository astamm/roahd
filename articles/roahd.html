<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>roahd • roahd</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="roahd">
<meta property="og:description" content="roahd">
<meta property="og:image" content="https://astamm.github.io/roahd/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">roahd</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4.3.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/roahd.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/astamm/roahd/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>roahd</h1>
                        <h4 data-toc-skip class="author">Nicholas Tarabelloni</h4>
            
            <h4 data-toc-skip class="date">2022-02-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/astamm/roahd/blob/HEAD/vignettes/roahd.Rmd" class="external-link"><code>vignettes/roahd.Rmd</code></a></small>
      <div class="hidden name"><code>roahd.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Package <strong>roahd</strong> (<strong>RO</strong>bust <strong>A</strong>nalysis of <strong>H</strong>igh dimensional <strong>D</strong>ata) is an <code>R</code> package meant to gather recently proposed statistical methods to deal with the robust analysis of functional data <span class="citation">(Francesca Ieva et al. 2019)</span>.</p>
<p>The package contains an implementation of quantitative methods, based on functional depths and indices, on top of which are built some graphical methods (functional boxplot and outliergram) useful to carry out an explorative analysis of a functional dataset and to robustify it by discarding shape and magnitude outliers.</p>
<p>Both univariate and multivariate functional data are supported in the package, whose functions have been implemented with a particular emphasis on computational efficiency, in order to allow the processing of high-dimensional dataset.</p>
</div>
<div class="section level2">
<h2 id="representation-of-functional-data">Representation of functional data<a class="anchor" aria-label="anchor" href="#representation-of-functional-data"></a>
</h2>
<p>The package has been designed to work with a representation of functional data through dedicated, simple and handy <code>S3</code> classes, namely <code>fData</code> for univariate functional data and <code>mfData</code> for multivariate functional data.</p>
<p>The use of <code>S3</code> classes is exploited by suitable <code>S3</code> methods implementing the statistical features of the package, that are able to dispatch the correct method call depending on the class of their functional data argument.</p>
<div class="section level3">
<h3 id="fdata">fData<a class="anchor" aria-label="anchor" href="#fdata"></a>
</h3>
<p><code>S3</code> class <code>fData</code> implements a representation of univariate functional datasets. They are obtained once specifying, for each observation in the functional dataset, a set of measurements over a discrete grid, representing the dependent variable indexing the functional dataset (e.g. time).</p>
<p>In other words, if we denote by <span class="math inline">\(T = [t_0, t_1, \ldots, t_{P-1}]\)</span> an evenly spaced grid (<span class="math inline">\(t_i - t_{i-1} = h &gt; 0\)</span>), and imagine to deal with a dataset <span class="math inline">\(D_{i,j} = X_i(t_j)\)</span>, <span class="math inline">\(\forall i = 1, \ldots, N\)</span> and <span class="math inline">\(\forall j=0, \ldots, P-1\)</span>, the object <code>fData</code> is built starting from the grid and the values in the following way:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span> <span class="va"><a href="https://astamm.github.io/roahd/">roahd</a></span> <span class="op">)</span>

<span class="co"># The number of observations in the functional dataset.</span>
<span class="va">N</span> <span class="op">=</span> <span class="fl">5</span>
<span class="co"># The number of points in the 1D grid where the functional data are measured.</span>
<span class="va">P</span> <span class="op">=</span> <span class="fl">1e2</span>
<span class="co"># The previous two variable names are used consistently throughout the tutorial</span>
<span class="co"># and the package's documentation to indicate the number of observations and the</span>
<span class="co"># grid size.</span>

<span class="co"># The grid over which the functional dataset is defined</span>
<span class="va">grid</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="va">P</span> <span class="op">)</span>

<span class="co"># Creating the values of the functional dataset</span>
<span class="va">Data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">grid</span>  <span class="op">)</span>,
                  <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">grid</span> <span class="op">)</span>,
                  <span class="fl">4</span> <span class="op">*</span> <span class="va">grid</span> <span class="op">*</span> <span class="op">(</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">grid</span> <span class="op">)</span>,
                  <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">tan</a></span><span class="op">(</span> <span class="va">grid</span> <span class="op">)</span>,
                  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span> <span class="va">grid</span> <span class="op">)</span> <span class="op">)</span>,
              nrow <span class="op">=</span> <span class="va">N</span>, ncol <span class="op">=</span> <span class="va">P</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span> <span class="op">)</span>

<span class="co"># Building an fData object</span>
<span class="co"># The constructor takes a grid and a matrix-like structure for data values</span>
<span class="co"># (see help for more details on how to use the constructor)</span>
<span class="va">fD</span> <span class="op">=</span> <span class="fu"><a href="../reference/fData.html">fData</a></span><span class="op">(</span> <span class="va">grid</span>, <span class="va">Data</span> <span class="op">)</span>

<span class="co"># Inspecting the structure of an fData object</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span> <span class="va">fD</span> <span class="op">)</span></code></pre></div>
<pre><code><span class="co">## List of 6</span>
<span class="co">##  $ t0    : num 0</span>
<span class="co">##  $ tP    : num 1</span>
<span class="co">##  $ h     : num 0.0101</span>
<span class="co">##  $ P     : int 100</span>
<span class="co">##  $ N     : int 5</span>
<span class="co">##  $ values: num [1:5, 1:100] 0 1 0 0 -Inf ...</span>
<span class="co">##  - attr(*, "class")= chr "fData"</span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="va">fD</span>, main <span class="op">=</span> <span class="st">'Univariate FD'</span>, xlab <span class="op">=</span> <span class="st">'time [s]'</span>, ylab <span class="op">=</span> <span class="st">'values'</span>, lwd <span class="op">=</span> <span class="fl">2</span> <span class="op">)</span></code></pre></div>
<p><img src="roahd_files/figure-html/fData-1.png" width="384" style="display: block; margin: auto;"> Thus, an object <code>fData</code> is a list containing: the fields <code>t0</code>, <code>tP</code>, defining the starting and end point of the one dimensional grid of the <code>fData</code> object, the constant step size <code>h</code> and the number of grid points <code>P</code> and the field <code>values</code> defining the measurements of the dataset over the one dimensional grid.</p>
</div>
<div class="section level3">
<h3 id="mfdata">mfData<a class="anchor" aria-label="anchor" href="#mfdata"></a>
</h3>
<p>An <code>mfData</code> object, instead, implements a multivariate functional dataset, i.e.  a collection of functions having more than one components, each one depending on the same variable. In practice, we deal with a discrete grid <span class="math inline">\([t_0, t_1, \ldots, t_{P-1}]\)</span> and a dataset of <span class="math inline">\(N\)</span> elements, each one having <span class="math inline">\(L\)</span> components observed over the same discrete grid: <span class="math inline">\(D_{i,j,k} = X_{i,k}(t_{j})\)</span>, <span class="math inline">\(\forall i = 1, \ldots, N\)</span>, <span class="math inline">\(\forall j = 0, \ldots, P - 1\)</span> and <span class="math inline">\(\forall k = 1, \ldots, L\)</span>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Creating some values for first component of the dataset</span>
<span class="va">Data_1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span> <span class="fl">10</span>, <span class="fl">0</span>, <span class="fl">4</span> <span class="op">)</span>, 
                    <span class="kw">function</span><span class="op">(</span> <span class="va">phase</span> <span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">grid</span> <span class="op">+</span> <span class="va">phase</span> <span class="op">)</span> <span class="op">)</span> <span class="op">)</span>

<span class="co"># Creating some values of functions for  </span>
<span class="va">Data_2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span> <span class="fl">10</span>, <span class="fl">0</span>, <span class="fl">4</span> <span class="op">)</span>, 
                    <span class="kw">function</span><span class="op">(</span> <span class="va">phase</span> <span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span> <span class="va">grid</span> <span class="op">+</span> <span class="va">phase</span> <span class="op">)</span> <span class="op">)</span> <span class="op">)</span>

<span class="co"># Building an fData object</span>
<span class="co"># The constructor takes a grid and a list of matrix-like structures for data values,</span>
<span class="co"># each one representing the data values of a single component of the dataset </span>
<span class="co"># (i.e. D_{,,k}, k = 1, ... L ).</span>
<span class="co"># (see help for more details on how to use the constructor)</span>
<span class="va">mfD</span> <span class="op">=</span> <span class="fu"><a href="../reference/mfData.html">mfData</a></span><span class="op">(</span> <span class="va">grid</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="va">Data_1</span>, <span class="va">Data_2</span> <span class="op">)</span> <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span> <span class="va">mfD</span> <span class="op">)</span></code></pre></div>
<pre><code><span class="co">## List of 6</span>
<span class="co">##  $ N     : int 10</span>
<span class="co">##  $ L     : int 2</span>
<span class="co">##  $ P     : int 100</span>
<span class="co">##  $ t0    : num 0</span>
<span class="co">##  $ tP    : num 1</span>
<span class="co">##  $ fDList:List of 2</span>
<span class="co">##   ..$ :List of 6</span>
<span class="co">##   .. ..$ t0    : num 0</span>
<span class="co">##   .. ..$ tP    : num 1</span>
<span class="co">##   .. ..$ h     : num 0.0101</span>
<span class="co">##   .. ..$ P     : int 100</span>
<span class="co">##   .. ..$ N     : int 10</span>
<span class="co">##   .. ..$ values: num [1:10, 1:100] 0.18 0.206 -0.676 0.784 0.534 ...</span>
<span class="co">##   .. ..- attr(*, "class")= chr "fData"</span>
<span class="co">##   ..$ :List of 6</span>
<span class="co">##   .. ..$ t0    : num 0</span>
<span class="co">##   .. ..$ tP    : num 1</span>
<span class="co">##   .. ..$ h     : num 0.0101</span>
<span class="co">##   .. ..$ P     : int 100</span>
<span class="co">##   .. ..$ N     : int 10</span>
<span class="co">##   .. ..$ values: num [1:10, 1:100] 0.858 1.04 1.026 0.362 -0.392 ...</span>
<span class="co">##   .. ..- attr(*, "class")= chr "fData"</span>
<span class="co">##  - attr(*, "class")= chr "mfData"</span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Each component of the mfData object is an fData object </span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span> <span class="va">mfD</span><span class="op">$</span><span class="va">fDList</span>, <span class="va">class</span> <span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "fData" "fData"</span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="va">mfD</span>, lwd <span class="op">=</span> <span class="fl">2</span>, main <span class="op">=</span> <span class="st">'Multivariate FD'</span>,
      xlab <span class="op">=</span> <span class="st">'time'</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="st">'Values 1'</span>, <span class="st">'Values 2'</span> <span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="roahd_files/figure-html/mfData-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The fact that <code>mfData</code> components are <code>fData</code> objects is indeed conceptually very natural, but also allows for a seamless application of <code>S3</code> methods meant for <code>fData</code> on multivariate functional data components, making the exploration and manipulation of multivariate datasets rather easy:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="va">mfD</span><span class="op">$</span><span class="va">fDList</span><span class="op">[[</span> <span class="fl">1</span> <span class="op">]</span><span class="op">]</span>, main <span class="op">=</span> <span class="st">'First component'</span>, 
      xlab <span class="op">=</span> <span class="st">'time'</span>, ylab <span class="op">=</span> <span class="st">'Values'</span>, lwd <span class="op">=</span> <span class="fl">2</span> <span class="op">)</span></code></pre></div>
<p>Moreover, <code>mfData</code> objects can be obtained also from a set of homogeneous <code>fData</code> objects, i.e. of equal sample size and defined on the same grid:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fD_1</span> <span class="op">=</span> <span class="fu"><a href="../reference/fData.html">fData</a></span><span class="op">(</span> <span class="va">grid</span>, <span class="va">Data_1</span> <span class="op">)</span>

<span class="va">fD_2</span> <span class="op">=</span> <span class="fu"><a href="../reference/fData.html">fData</a></span><span class="op">(</span> <span class="va">grid</span>, <span class="va">Data_2</span> <span class="op">)</span>

<span class="va">mfD</span> <span class="op">=</span> <span class="fu"><a href="../reference/as.mfData.html">as.mfData</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="va">fD_1</span>, <span class="va">fD_2</span> <span class="op">)</span> <span class="op">)</span> 

<span class="va">mfD</span> <span class="op">=</span> <span class="fu"><a href="../reference/as.mfData.html">as.mfData</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span> <span class="fl">1</span> <span class="op">:</span> <span class="fl">10</span>, <span class="kw">function</span><span class="op">(</span> <span class="va">i</span> <span class="op">)</span><span class="op">(</span> <span class="va">fD_1</span> <span class="op">)</span> <span class="op">)</span> <span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="subsetting-fdata">Subsetting fData<a class="anchor" aria-label="anchor" href="#subsetting-fdata"></a>
</h3>
<p><code>fData</code> objects can be subset using a suitably overloaded operator <code>[.fData</code>, that allows for the use of standard slices of <code>matrix</code> and <code>array</code> classes also for <code>fData</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Subsetting fData and returning result in matrix form</span>
<span class="va">fD</span><span class="op">[</span> <span class="fl">1</span> , <span class="fl">1</span>, as_fData <span class="op">=</span> <span class="cn">FALSE</span> <span class="op">]</span>

<span class="va">fD</span><span class="op">[</span> <span class="fl">1</span>, , as_fData <span class="op">=</span> <span class="cn">FALSE</span> <span class="op">]</span>

<span class="va">fD</span><span class="op">[</span> <span class="fl">2</span>, <span class="fl">10</span> <span class="op">:</span> <span class="fl">20</span>, as_fData <span class="op">=</span> <span class="cn">FALSE</span> <span class="op">]</span>

<span class="va">fD</span><span class="op">[</span> , <span class="fl">10</span>, as_fData <span class="op">=</span> <span class="cn">FALSE</span> <span class="op">]</span>

<span class="co"># As default behavior the subset is returned in fData form</span>
<span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fD</span>, main <span class="op">=</span> <span class="st">"Original dataset"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fD</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>, main <span class="op">=</span> <span class="st">"Zooming in"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="algebra">Algebra<a class="anchor" aria-label="anchor" href="#algebra"></a>
</h3>
<p>An algebra of <code>fData</code> objects is also implemented, making it easy to sum, subtract, multiply and divide these objects by meaningful and compliant structures.</p>
<p><strong>Sums</strong> and <strong>subtractions</strong>, available through <code>+</code> and <code>-</code> operators (see help at <code>+-.fData</code>), allow to sum an <code>fData</code> on the left hand side and a compliant structure on the right hand side. This can be either another <code>fData</code> of the same sample size and defined over the same grid, or a 1D/2D data structure with a number of columns equal <code>fData</code>’s grid length (i.e. <code>P</code>), and number of rows equal to <code>fData</code>’s sample size (i.e. <code>N</code>) or equal to one (in this case the only observation available is recycled <code>N</code> times). The operations are then performed element-wise between the lhs and rhs.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fD</span> <span class="op">+</span> <span class="va">fD</span>

<span class="va">fD</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="va">N</span>, ncol <span class="op">=</span> <span class="va">P</span> <span class="op">)</span>

<span class="va">fD</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span> <span class="fl">2</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="va">N</span>, <span class="va">P</span> <span class="op">)</span> <span class="op">)</span>

<span class="va">fD</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">:</span> <span class="va">P</span> </code></pre></div>
<p><strong>Multiplication</strong> and <strong>division</strong>, instead, is implemented only for an <code>fData</code> left hand side and a numeric variable or numeric vector right hand side. In the first case, each function in the functional dataset is multiplied/divided by the specified quantity; in the second case, specifying a vector of length <code>N</code>, the multiplication/division of each functional observation is carried out by the corresponding quantity in the vector, in an element-wise way:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fD</span> <span class="op">*</span> <span class="fl">2</span>

<span class="va">fD</span> <span class="op">/</span> <span class="fl">3</span>

<span class="va">fD</span> <span class="op">*</span> <span class="op">(</span> <span class="fl">1</span> <span class="op">:</span> <span class="va">N</span> <span class="op">)</span>

<span class="va">fD</span> <span class="op">/</span> <span class="op">(</span> <span class="fl">1</span> <span class="op">:</span> <span class="va">N</span> <span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h3>
<p><code>fData</code> and <code>mfData</code> objects can be visualized thanks to specific <code>S3</code> plotting methods, <code>plot.fData</code> and <code>plot.mfData</code>.</p>
<p>The graphical parameters of these functions have been suitably customized in order to enhance the visualization of functions. In particular, elements are plotted by default with continuous lines and an ad-hoc palette that helps differentiating them. As default x- and y-axis labels, as well as titles, are dropped so that plot’s arguments calls are not displayed when no value is provided.</p>
<p>In case of <code>mfData</code> the graphical window is split into a rectangular lattice to plot single dimensions. The rectangular frame has <code>floor( sqrt( L ) )</code> rows and <code>ceiling( x$L / floor( sqrt( x$L ) ) )</code> columns. If custom labels/titles are desired, they must be provided in the following way: since the grid is the same for all the dimensions, just one string is expected for x-axis (e.g. <code>xlab = 'grid'</code>), while either a single string or a list of <code>L</code> strings (one for each dimension) is expected for both the y-axis label(s) and title(s). In case just one string is passed to <code>plot.mfData</code>, the same value is used for all the dimensions.</p>
</div>
</div>
<div class="section level2">
<h2 id="statistics">Statistics<a class="anchor" aria-label="anchor" href="#statistics"></a>
</h2>
<div class="section level3">
<h3 id="depths">Depths<a class="anchor" aria-label="anchor" href="#depths"></a>
</h3>
<p><code>roahd</code> provides a number of depth definitions, that are exploited by the visualization functions but can also be used by themselves. These are based on the notion of <strong>Band Depth</strong> <span class="citation">(López-Pintado and Romo 2007, 2009)</span>.</p>
<p><strong>Band Depth</strong> and <strong>Modified Band Depth</strong> are implemented in the functions <code>BD</code> and <code>MBD</code>. Both of them can work with either an <code>fData</code> object, specifying the univariate functional dataset whose depths must be computed, or a matrix of data values (e.g. in the form of <code>fData$values</code> output). <code>MBD</code> can be called with the additional parameters <code>manage_ties</code> (defaulting to <code>FALSE</code>), specifying whether a check for the presence of tied data must be made prior to computing depths, and therefore a suitable computing strategy must be used. The implementation of <code>MBD</code> exploits the recommendations of <span class="citation">(Sun, Genton, and Nychka 2012)</span>, but extends them in order to accommodate for the possible presence of ties.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="../reference/BD.html">BD</a></span><span class="op">(</span> <span class="va">fD</span> <span class="op">)</span>
  <span class="fu"><a href="../reference/BD.html">BD</a></span><span class="op">(</span> <span class="va">fD</span><span class="op">$</span><span class="va">values</span> <span class="op">)</span>
  
  <span class="fu"><a href="../reference/MBD.html">MBD</a></span><span class="op">(</span> <span class="va">fD</span> <span class="op">)</span>
  <span class="fu"><a href="../reference/MBD.html">MBD</a></span><span class="op">(</span> <span class="va">fD</span><span class="op">$</span><span class="va">values</span> <span class="op">)</span>
  
  <span class="fu"><a href="../reference/MBD.html">MBD</a></span><span class="op">(</span> <span class="va">fD</span>, manage_ties <span class="op">=</span> <span class="cn">TRUE</span> <span class="op">)</span>
  <span class="fu"><a href="../reference/MBD.html">MBD</a></span><span class="op">(</span> <span class="va">fD</span><span class="op">$</span><span class="va">values</span>, manage_ties <span class="op">=</span> <span class="cn">TRUE</span> <span class="op">)</span></code></pre></div>
<p>Another definition available is the <strong>Half Region Depth</strong> (along with its modified version), that is built on top of the <strong>Epigraph</strong> and <strong>Hypograph</strong> indexes <span class="citation">(see López-Pintado and Romo 2011)</span>:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/HRD.html">HRD</a></span><span class="op">(</span> <span class="va">fD</span> <span class="op">)</span>
<span class="fu"><a href="../reference/HRD.html">HRD</a></span><span class="op">(</span> <span class="va">fD</span><span class="op">$</span><span class="va">values</span> <span class="op">)</span>

<span class="fu"><a href="../reference/MHRD.html">MHRD</a></span><span class="op">(</span> <span class="va">fD</span> <span class="op">)</span>
<span class="fu"><a href="../reference/MHRD.html">MHRD</a></span><span class="op">(</span> <span class="va">fD</span><span class="op">$</span><span class="va">values</span> <span class="op">)</span></code></pre></div>
<p>A generalization of MBD to multivariate functional data, implementing the ideas of <span class="citation">F. Ieva and Paganoni (2013)</span>, is also available through the functions <code>multiBD</code> and <code>multiMBD</code>. These functions accept either a <code>mfData</code> object, specifying the multivariate functional dataset whose depths have to be computed, or a list of matrices of data values (see example below).</p>
<p>The function computes the BD or MBD for each component of the multivariate functional dataset and then averages them according to a set of weights. These can be specified in two ways: either with the flag <code>uniform</code>, that is turned into <code>rep( 1/L, L )</code> (where <code>L</code> stands for the number of components in the multivariate dataset), or by providing the actual set of weights to be used. The latter option allows to use ad-hoc set of weights, like in <span class="citation">(Tarabelloni et al. 2015)</span>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="../reference/multiMBD.html">multiBD</a></span><span class="op">(</span> <span class="va">mfD</span>, weights <span class="op">=</span> <span class="st">'uniform'</span> <span class="op">)</span>
  <span class="fu"><a href="../reference/multiMBD.html">multiMBD</a></span><span class="op">(</span> <span class="va">mfD</span>, weights <span class="op">=</span> <span class="st">'uniform'</span>, manage_ties <span class="op">=</span> <span class="cn">FALSE</span> <span class="op">)</span>

  <span class="fu"><a href="../reference/multiMBD.html">multiBD</a></span><span class="op">(</span> <span class="va">mfD</span>, weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0.6</span>, <span class="fl">0.4</span><span class="op">)</span> <span class="op">)</span>
  <span class="fu"><a href="../reference/multiMBD.html">multiMBD</a></span><span class="op">(</span> <span class="va">mfD</span>, weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0.7</span>, <span class="fl">0.3</span> <span class="op">)</span>, manage_ties <span class="op">=</span> <span class="cn">FALSE</span> <span class="op">)</span>

  <span class="fu"><a href="../reference/multiMBD.html">multiBD</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="va">fD_1</span><span class="op">$</span><span class="va">values</span>, <span class="va">fD_2</span><span class="op">$</span><span class="va">values</span> <span class="op">)</span>, weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0.6</span>, <span class="fl">0.4</span><span class="op">)</span> <span class="op">)</span>
  <span class="fu"><a href="../reference/multiMBD.html">multiMBD</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="va">fD_1</span><span class="op">$</span><span class="va">values</span>, <span class="va">fD_2</span><span class="op">$</span><span class="va">values</span> <span class="op">)</span>, weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0.7</span>, <span class="fl">0.3</span> <span class="op">)</span>, manage_ties <span class="op">=</span> <span class="cn">FALSE</span> <span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mean-and-median">Mean and median<a class="anchor" aria-label="anchor" href="#mean-and-median"></a>
</h3>
<p>Suitable <code>S3</code> extensions to the functions for the computation of mean function and median of functional datasets are also present.</p>
<p>The sample mean of a functional dataset coincides with the <em>cross-sectional</em> mean function, i.e. the function obtained by computing the mean across the whole dataset point-by-point along the grid where functional data are defined:</p>
<p><span class="math display">\[
\widehat{\mu}( t_j ) = \dfrac{1}{N} \sum_{i=1}^{N} X_i(t_j), \qquad \forall j = 0, \ldots, P-1
\]</span></p>
<p>for a univariate functional dataset, while in the multivariate case is:</p>
<p><span class="math display">\[
  \widehat{\mu}_k(t_j) = \dfrac{1}{N} \sum_{i=1}^{N} X_{i,k}(t_j), \qquad \forall j = 0, \ldots, P-1,
  \qquad \forall k = 1, \ldots, L.
\]</span></p>
<p>The sample median of a functional dataset, instead, is defined as the element of the functional dataset fulfilling the maximum depths, given a certain definition of depth. For instance, for MBD:</p>
<p><span class="math display">\[
  \widehat{m}( t_j ) = \left(\text{arg}\max_{i=1, \ldots, N} MBD( X_i )\right)( t_j), \qquad j = 0, \ldots, P-1.
\]</span></p>
<p>The sample mean is implemented in the <code>S3</code> methods <code>mean.fData( x, ... )</code> and <code>mean.mfData( x, ... )</code>, that can be invoked directly on <code>fData</code> and <code>mfData</code> objects. These methods can be called directly without the <code>.fData</code> or <code>.mfData</code> suffix, due to their <code>S3</code> nature and call, that allows them to be dispatched from the standard <code>mean</code> function. The sample median, instead, is implemented in the functions <code>median_fData( fData, type = 'MBD', ... )</code> and <code>median_mfData( mfData, type = 'multiMBD', ... )</code>. Here, the <code>type</code> flag can take any name of functions (available in the caller’s environment) that can be used to compute the depths defining the sample median, taking respectively a 2D matrix of data values and a list of 2D matrix of data values as argument (plus, optionally, the dots arguments).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="co"># Exploiting the S3 nature of these functions and the dispatching from the </span>
  <span class="co"># standard `mean` function</span>
  <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span> <span class="va">fD</span> <span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span> <span class="va">mfD</span><span class="op">)</span>
  
  <span class="fu"><a href="../reference/median_fData.html">median_fData</a></span><span class="op">(</span> <span class="va">fD</span>, type <span class="op">=</span> <span class="st">'MBD'</span> <span class="op">)</span>
  <span class="fu"><a href="../reference/median_fData.html">median_fData</a></span><span class="op">(</span> <span class="va">fD</span>, type <span class="op">=</span> <span class="st">'MHRD'</span> <span class="op">)</span>

  <span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fD</span>, main <span class="op">=</span> <span class="st">"Mean"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">fD</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"black"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fD</span>, main <span class="op">=</span> <span class="st">"Median"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/median_fData.html">median_fData</a></span><span class="op">(</span><span class="va">fD</span>, type <span class="op">=</span> <span class="st">"MBD"</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="covariance-and-cross-covariance-functions">Covariance and cross-covariance functions<a class="anchor" aria-label="anchor" href="#covariance-and-cross-covariance-functions"></a>
</h3>
<p>The computation of covariance functions and cross-covariance functions for univariate and multivariate functional datasets is provided through the function <code>cov_fun( X, Y = NULL )</code>.</p>
<p>Given a univariate functional dataset, <span class="math inline">\(X_1, X_2, \ldots, X_N\)</span>, defined over the grid <span class="math inline">\([t_0, t_1, \ldots, t_P] \subset I\)</span>, its covariance function (evaluated over the grid) is <span class="math inline">\(C(t_i,t_j) = Cov(X(t_i),X(t_j))\)</span> for <span class="math inline">\(i,j=1,\ldots,P\)</span>. Given another univariate functional dataset <span class="math inline">\(Y_1, Y_2, \ldots, Y_N\)</span>, the cross-covariance function is <span class="math inline">\(C_{X,Y}(t_i,t_j) = Cov(X(t_i),Y(t_j))\)</span>.</p>
<p>Given a multivariate functional dataset with observations of <span class="math inline">\(L\)</span> components, <span class="math inline">\(X_1, X_2,\ldots, X_N\)</span>, the covariance function has the following block structure: <span class="math inline">\(C^{k,l} = [ Cov(X_k(t_i),X_l(t_j))]_{i,j=1}^{P}\)</span>, for <span class="math inline">\(k,l = 1, \ldots, L\)</span>. Of course, it is <span class="math inline">\(C^{k,l} = [C^{l,k}]^T\)</span>. Analogously, the cross-covariance between two multivariate datasets is given by the cross covariances of the components.</p>
<p>When <code>X</code> is a univariate functional dataset, and if <code>Y</code> is <code>NULL</code>, <code>cov_fun</code> returns the sample covariance function of the functional dataset, defined over the tensorized grid where <code>X</code> is defined. If <code>Y</code> is a univariate functional dataset (in form of <code>fData</code> object), the method returns the cross-covariance function of <code>X</code> and <code>Y</code>.</p>
<p>When <code>X</code> is a multivariate dataset, <code>Y</code> can be <code>NULL</code>, an <code>fData</code> or a <code>mfData</code> object. In the first case the method returns the covariance function of <code>X</code>, in form of a list of <em>only</em> the upper-triangular blocks. The blocks are sorted in the list by row, therefore the first is the covariance of the first component, then the cross-covariance of the first component with the second, etc. In the second case, the method returns the list of cross-covariances between <code>X</code>’s components and <code>Y</code>. In the third case, the method returns the list of upper-triangular blocks of cross-covariances between <code>X</code>’s and <code>Y</code>’s components.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="co"># Simple covariance function</span>
    <span class="va">C1</span> <span class="op">=</span> <span class="fu"><a href="../reference/cov_fun.html">cov_fun</a></span><span class="op">(</span> <span class="va">fD</span> <span class="op">)</span>

    <span class="co"># Cross-covariance function of first and second component of mfD</span>
    <span class="va">CC</span> <span class="op">=</span> <span class="fu"><a href="../reference/cov_fun.html">cov_fun</a></span><span class="op">(</span> <span class="va">mfD</span><span class="op">$</span><span class="va">fDList</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">mfD</span><span class="op">$</span><span class="va">fDList</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">)</span>

    <span class="co"># Block-covariance function of mfD</span>
    <span class="va">BC</span> <span class="op">=</span> <span class="fu"><a href="../reference/cov_fun.html">cov_fun</a></span><span class="op">(</span> <span class="va">mfD</span> <span class="op">)</span></code></pre></div>
<p>Each covariance function estimate (the elements of the list in the multivariate case, too) is returned as an instance of the <code>S3</code> class <code>Cov</code>, that stores the values of the covariance matrix as well as the grid parameters.</p>
<p><code>plot.Cov</code>, an <code>S3</code> specialization of <code>plot</code> is available as plotting method for <code>Cov</code> objects. It is built around <code><a href="https://rdrr.io/r/graphics/image.html" class="external-link">graphics::image</a></code>, hence all the additional parameters of <code>image</code> can be used to customize it.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="va">C1</span>, main <span class="op">=</span> <span class="st">'Covariance function'</span>, xlab <span class="op">=</span> <span class="st">'time'</span>, ylab <span class="op">=</span> <span class="st">'time'</span> <span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="indexes">Indexes<a class="anchor" aria-label="anchor" href="#indexes"></a>
</h3>
<p><code>roahd</code> collects the implementation of some useful indexes that can be used to describe and summarize functional datasets.</p>
<p><code>EI</code> and <code>MEI</code> implement the <strong>Epigraph Index</strong> and the <strong>Modified Epigraph Index</strong>, while <code>HI</code> and <code>MHI</code> implement the <strong>Hypograph Index</strong> and the <strong>Modified Hypograph Index</strong> <span class="citation">(see López-Pintado and Romo 2011; Arribas-Gil and Romo 2014)</span>. These indexes can be used to sort data in a top-down and bottom-up fashion, and are used to define the HRD/MHRD and to build the outliergram.</p>
<p>These <code>S3</code> methods can be called on univariate functional datasets, provided either in form of a <code>fData</code> object or a 2D matrix of values.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="co"># Calling on fData objects</span>
  <span class="fu"><a href="../reference/EI.html">EI</a></span><span class="op">(</span> <span class="va">fD</span> <span class="op">)</span>
  <span class="fu"><a href="../reference/MEI.html">MEI</a></span><span class="op">(</span> <span class="va">fD</span> <span class="op">)</span>
  
  <span class="fu"><a href="../reference/HI.html">HI</a></span><span class="op">(</span> <span class="va">fD</span> <span class="op">)</span>
  <span class="fu"><a href="../reference/MHI.html">MHI</a></span><span class="op">(</span> <span class="va">fD</span> <span class="op">)</span>

  <span class="co"># Calling on 2D matrix type objects</span>
  <span class="fu"><a href="../reference/EI.html">EI</a></span><span class="op">(</span> <span class="va">fD</span><span class="op">$</span><span class="va">values</span> <span class="op">)</span>
  <span class="fu"><a href="../reference/EI.html">EI</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span> <span class="fl">20</span> <span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">5</span> <span class="op">)</span> <span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="correlation-coefficients">Correlation coefficients<a class="anchor" aria-label="anchor" href="#correlation-coefficients"></a>
</h3>
<p>When dealing with multivariate functional data, in particular in case of <strong>bivariate</strong> data, it is possible to compute correlation coefficients between data components that generalize the Kendall’s tau and Spearman’s coefficients <span class="citation">(Valencia, Romo, and Lillo 2015a, 2015b)</span>.</p>
<p>The function <code>cor_kendall( mfD, ordering = 'max' )</code> allows to compute the Kendall’s tau correlation coefficient between components of a bivariate dataset. The function accepts a <code>mfData</code> object and a criterion to perform the ordering of functional data (this ordering is used to determine the concordances and discordances between pairs in the definition of the coefficient).</p>
<p>Two criteria are available so far, that directly reflect those proposed in the reference paper: <code>max</code>, for the ordering between maxima of functions, and <code>area</code>, for the ordering between area-under-the-curve of functions.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">N</span> <span class="op">=</span> <span class="fl">10</span>
  <span class="va">P</span> <span class="op">=</span> <span class="fl">1e3</span>

  <span class="va">grid</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="va">P</span> <span class="op">)</span>
  
  <span class="va">Data_1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span> <span class="fl">1</span> <span class="op">:</span> <span class="va">N</span>, <span class="kw">function</span><span class="op">(</span> <span class="va">i</span> <span class="op">)</span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">grid</span> <span class="op">)</span> <span class="op">+</span> <span class="va">i</span> <span class="op">)</span> <span class="op">)</span> <span class="op">)</span>
 
  <span class="co"># Monotone nonlinear transformation of data</span>
  <span class="va">Data_2</span> <span class="op">=</span> <span class="va">Data_1</span><span class="op">^</span><span class="fl">3</span>
  
  <span class="va">mfD</span> <span class="op">=</span> <span class="fu"><a href="../reference/mfData.html">mfData</a></span><span class="op">(</span> <span class="va">grid</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="va">Data_1</span>, <span class="va">Data_2</span> <span class="op">)</span> <span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="va">mfD</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="st">'Comp. 1'</span>, <span class="st">'Comp. 2'</span><span class="op">)</span> <span class="op">)</span>  </code></pre></div>
<p><img src="roahd_files/figure-html/cor_kendall_1-1.png" width="700"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="co"># Kendall correlation of monotonically dependent data is exactly 1</span>
  <span class="fu"><a href="../reference/cor_kendall.html">cor_kendall</a></span><span class="op">(</span> <span class="va">mfD</span>, ordering <span class="op">=</span> <span class="st">'max'</span> <span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 1</span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="../reference/cor_kendall.html">cor_kendall</a></span><span class="op">(</span> <span class="va">mfD</span>, ordering <span class="op">=</span> <span class="st">'area'</span> <span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 1</span></code></pre>
<p>The function <code>cor_spearman( mfD, ordering = 'MEI', ... )</code> can be used to compute the Spearman correlation coefficient for a bivariate <code>mfData</code> object, tuning the ordering policy specified by <code>ordering</code> (defaulting to <code>MEI</code>) to rank univariate components and then compute the correlation coefficient. Besides <code>MEI</code>, also <code>MHI</code> can be used to rank univariate components.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Spearman correlation of monotonically dependent data is exactly 1</span>
  <span class="fu"><a href="../reference/cor_spearman.html">cor_spearman</a></span><span class="op">(</span> <span class="va">mfD</span>, ordering <span class="op">=</span> <span class="st">'MEI'</span> <span class="op">)</span>
<span class="co">## [1] 1</span>
  <span class="fu"><a href="../reference/cor_spearman.html">cor_spearman</a></span><span class="op">(</span> <span class="va">mfD</span>, ordering <span class="op">=</span> <span class="st">'MHI'</span> <span class="op">)</span>
<span class="co">## [1] 1</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="simulation-of-functional-data">Simulation of functional data<a class="anchor" aria-label="anchor" href="#simulation-of-functional-data"></a>
</h2>
<p><code>roahd</code> contains also some functions that can be used to simulate artificial data sets of functional data, both univariate and multivariate. These are used in the adjustment procedure of the outliergram and functional boxplot, but can also be used to help the development of new methodologies and help their testing.</p>
<p>Artificial univariate data are obtained simulating realizations of a gaussian process over a discrete grid with a specific covariance function and center (e.g. mean or median). Given a covariance function, <span class="math inline">\(C(s,t)\)</span> and a centerline <span class="math inline">\(m(t)\)</span>, the model generating data is: <span class="math display">\[X_i(t) = m(t) + \epsilon(t), \quad Cov(\epsilon(s),\epsilon(t)) = C(s,t), \quad i = 1, \ldots, N.\]</span></p>
<div class="section level3">
<h3 id="univariate-functional-data">Univariate functional data<a class="anchor" aria-label="anchor" href="#univariate-functional-data"></a>
</h3>
<p>The function <code>generate_gauss_fdata(N, centerline, Cov = NULL, CholCov = NULL)</code> can be used to simulate a population of such gaussian functional data. The required arguments are: <code>N</code> the number of elements to be generated; <code>centerline</code>, the center of the distribution (mean or median); <code>Cov</code>, a matrix representation of the desired covariance function, intended as the measurements of such function over a tensor grid whose marginal must be the grid where the functional data will be defined (i.e. the argument <code>grid</code> in <code>fData</code>); <code>CholCov</code> the Cholesky factor of the discrete representation of the covariance function over the tensor grid (optional and alternative to the argument <code>Cov</code>). The inner procedure to generate the synthetic population of gaussian functional data makes use of the Cholesky factor of <code>Cov</code>, hence by providing its Cholesky factor, if already present in the caller’s scope, can save computing time.</p>
<p>A built-in function can be used to generate exponential-like covariance functions, namely <code>exp_cov_function( grid, alpha, beta )</code>, generating the discretized version of a covariance of the form <span class="math inline">\(C(s,t) = \alpha e^{-\beta | s - t | }\)</span> over a lattice given by the tensorization of grid in <code>grid</code>.</p>
<p>A comprehensive example is the following:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">N</span> <span class="op">=</span> <span class="fl">50</span>
  <span class="va">P</span> <span class="op">=</span> <span class="fl">1e3</span>

  <span class="va">grid</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="va">P</span> <span class="op">)</span>
  
  <span class="va">Cov</span> <span class="op">=</span> <span class="fu"><a href="../reference/exp_cov_function.html">exp_cov_function</a></span><span class="op">(</span> <span class="va">grid</span>, alpha <span class="op">=</span> <span class="fl">0.2</span>, beta  <span class="op">=</span> <span class="fl">0.3</span> <span class="op">)</span>
  
  <span class="va">Data</span> <span class="op">=</span> <span class="fu"><a href="../reference/generate_gauss_fdata.html">generate_gauss_fdata</a></span><span class="op">(</span> <span class="va">N</span>, centerline <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">grid</span> <span class="op">)</span>, Cov <span class="op">=</span> <span class="va">Cov</span> <span class="op">)</span>
  
  <span class="va">fD</span> <span class="op">=</span> <span class="fu"><a href="../reference/fData.html">fData</a></span><span class="op">(</span> <span class="va">grid</span>, <span class="va">Data</span> <span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="va">fD</span>, main <span class="op">=</span> <span class="st">'Gaussian fData'</span>, xlab <span class="op">=</span> <span class="st">'grid'</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="roahd_files/figure-html/simulation_univariate-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="multivariate-functional-data">Multivariate functional data<a class="anchor" aria-label="anchor" href="#multivariate-functional-data"></a>
</h3>
<p>The function <code>generate_gauss_mfdata( N, L, centerline, correlations, listCov = NULL, listCholCov = NULL)</code> can be used to generate a gaussian dataset of multivariate functional data. The model generating data is the following:</p>
<p><span class="math display">\[ X_{i,k} = m_k(t) + \epsilon_k(t), \quad Cov(\epsilon_k(s),\epsilon_k(t))=C(s,t), \quad
\forall i = 1, \ldots, N, \quad \forall k = 1, \ldots, L,\]</span></p>
<p>where <span class="math inline">\(Cor( \epsilon_j(t),\epsilon_l(t))=\rho_{j,l}\)</span> specifies a (<em>synchronous</em>) correlation structure among the components of the functional dataset.</p>
<p>In order to use the function one should provide: <code>N</code>, the number of elements to simulate; <code>L</code>, the number of components of the multivariate functional data; <code>centerline</code>, a matrix containing (by rows) the centerline for each component; <code>correlations</code>, a vector of length <code>1/2 * L * ( L - 1 )</code>, containing all the correlation coefficients among the components; either <code>listCov</code> or <code>listCholCov</code>, a list containing either the discretized covariance functions over the tensorized grid where functional data will be defined), or their Cholesky factor.</p>
<p>A comprehensive example is the following:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">N</span> <span class="op">=</span> <span class="fl">10</span>
  <span class="va">P</span> <span class="op">=</span> <span class="fl">1e3</span>

  <span class="va">grid</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="va">P</span> <span class="op">)</span>
  
  <span class="va">Cov_1</span> <span class="op">=</span> <span class="fu"><a href="../reference/exp_cov_function.html">exp_cov_function</a></span><span class="op">(</span> <span class="va">grid</span>, alpha <span class="op">=</span> <span class="fl">0.1</span>, beta  <span class="op">=</span> <span class="fl">0.5</span> <span class="op">)</span>
  <span class="va">Cov_2</span> <span class="op">=</span> <span class="fu"><a href="../reference/exp_cov_function.html">exp_cov_function</a></span><span class="op">(</span> <span class="va">grid</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, beta <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
  
  <span class="va">centerline</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">grid</span> <span class="op">)</span>,
                          <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">grid</span> <span class="op">)</span> <span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span> <span class="op">)</span>
  
  <span class="va">Data</span> <span class="op">=</span> <span class="fu"><a href="../reference/generate_gauss_mfdata.html">generate_gauss_mfdata</a></span><span class="op">(</span> <span class="va">N</span>, <span class="fl">2</span>, <span class="va">centerline</span>, <span class="fl">0.8</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="va">Cov</span>, <span class="va">Cov</span> <span class="op">)</span> <span class="op">)</span>
  
  <span class="va">mfD</span> <span class="op">=</span> <span class="fu"><a href="../reference/mfData.html">mfData</a></span><span class="op">(</span> <span class="va">grid</span>, <span class="va">Data</span> <span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="va">mfD</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="st">'Comp.1'</span>, <span class="st">'Comp. 2'</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">'grid'</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="roahd_files/figure-html/simulation_multivariate-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="robustification">Robustification<a class="anchor" aria-label="anchor" href="#robustification"></a>
</h2>
<div class="section level3">
<h3 id="functional-boxplot">Functional boxplot<a class="anchor" aria-label="anchor" href="#functional-boxplot"></a>
</h3>
<p>An implementation of the functional boxplot, through the <code>S3</code> method <code>fbplot</code>, allows for the detection of <em>amplitude</em> outliers in univariate and multivariate functional datasets <span class="citation">(see Sun and Genton 2011)</span>.</p>
<p><code>fbplot</code> can be used to compute the set of indices of observations marking outlying signals. If used in graphical way (default behavior), it also plots the functional boxplot of the dataset under study</p>
<p>The functional boxplot is obtained by ranking functions from the center of the distribution outwards thanks to a depth definition, computing the region of 50% most central functions and inflating such region by a factor <code>F</code>. Any function crossing these boundaries is flagged as outlier. The default value for <code>F</code> is <code>1.5</code>, otherwise it can be set with the argument <code>Fvalue</code>.</p>
<p>The argument <code>Depths</code> can take either the name of the function to call in order to compute the depths (default is <code>MBD</code>), or a vector containing the depth values for the provided dataset.</p>
<p>An example is:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1618</span><span class="op">)</span>

  <span class="va">N</span> <span class="op">=</span> <span class="fl">1e2</span>
  <span class="va">P</span> <span class="op">=</span> <span class="fl">1e2</span>
  
  <span class="va">grid</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="va">P</span> <span class="op">)</span>
  
  <span class="va">Cov</span> <span class="op">=</span> <span class="fu"><a href="../reference/exp_cov_function.html">exp_cov_function</a></span><span class="op">(</span> <span class="va">grid</span>, alpha <span class="op">=</span> <span class="fl">0.2</span>, beta <span class="op">=</span> <span class="fl">0.3</span> <span class="op">)</span>
  
  <span class="va">Data</span> <span class="op">=</span> <span class="fu"><a href="../reference/generate_gauss_fdata.html">generate_gauss_fdata</a></span><span class="op">(</span> <span class="va">N</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">grid</span> <span class="op">)</span>, <span class="va">Cov</span> <span class="op">)</span>
  
  <span class="va">fD</span> <span class="op">=</span> <span class="fu"><a href="../reference/fData.html">fData</a></span><span class="op">(</span> <span class="va">grid</span>, <span class="va">Data</span> <span class="op">)</span>
  
  <span class="va">Data</span> <span class="op">=</span> <span class="fu"><a href="../reference/generate_gauss_mfdata.html">generate_gauss_mfdata</a></span><span class="op">(</span> <span class="va">N</span>, <span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">grid</span> <span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="va">P</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span> <span class="op">)</span>, <span class="fl">0.6</span>, listCov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="va">Cov</span>, <span class="va">Cov</span> <span class="op">)</span> <span class="op">)</span>

  <span class="va">mfD</span> <span class="op">=</span> <span class="fu"><a href="../reference/mfData.html">mfData</a></span><span class="op">(</span> <span class="va">grid</span>, <span class="va">Data</span> <span class="op">)</span>
  
  <span class="fu"><a href="../reference/fbplot.html">fbplot</a></span><span class="op">(</span> <span class="va">fD</span>, main <span class="op">=</span> <span class="st">'Fbplot'</span>, Fvalue <span class="op">=</span> <span class="fl">3.5</span> <span class="op">)</span></code></pre></div>
<p><img src="roahd_files/figure-html/fbplot_fData-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="../reference/fbplot.html">fbplot</a></span><span class="op">(</span> <span class="va">mfD</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="st">'Comp. 1'</span>, <span class="st">'Comp. 2'</span> <span class="op">)</span>, Fvalue <span class="op">=</span> <span class="fl">3.5</span> <span class="op">)</span></code></pre></div>
<p><img src="roahd_files/figure-html/fbplot_fData-2.png" width="672" style="display: block; margin: auto;"></p>
<p>The method <code>fboplot.fData</code> also allows to automatically compute the best adjustment factor <code>F</code> that yields a desired proportion of outliers (True Positive Rate, <code>TPR</code>) out of a Gaussian dataset with same center and covariance function as the <code>fData</code> object <span class="citation">(see Sun and Genton 2012)</span>.</p>
<p>Such automatic tuning involves the simulation of a number <code>N_trials</code> of populations of Gaussian functional data with same center and covariance as the original dataset (the covariance is robustly estimated with <code><a href="https://rdrr.io/pkg/robustbase/man/covOGK.html" class="external-link">robustbase::covOGK</a></code>) of size <code>trial_size</code>, and the computation of <code>N_trials</code> values for <code>Fvalue</code> such that the desired proportion <code>TPR</code> of observations is flagged as outliers. The optimal value of <code>Fvalue</code> for the original population is then found as the average of the previously computed values <code>Fvalue</code>. The computation of the optimal <code>Fvalue</code> at each iteration of the procedure is carried out exploiting the zero-finding algorithm in <code><a href="https://rdrr.io/r/stats/uniroot.html" class="external-link">stats::uniroot</a></code> (Brent’s method).</p>
<p>The parameters to control the adjustment procedure can be passed through the argument <code>adjust</code>, whose default is <code>FALSE</code> and otherwise is a list with (some of) the fields:</p>
<ul>
<li>
<code>N_trials</code>: the number of repetitions of the adjustment procedure based on the simulation of a gaussian population of functional data, each one producing an adjusted value of F, which will lead to the averaged adjusted value <code>Fvalue</code>. Default is 20;</li>
<li>
<code>trial_size</code>: the number of elements in the gaussian population of functional data that will be simulated at each repetition of the adjustment procedure. Default is 8 * <code>Data$N</code>;</li>
<li>
<code>TPR</code>: the True Positive Rate of outliers, i.e. the proportion of observations in a dataset without amplitude outliers that have to be considered outliers. Default is <code>2 * pnorm( 4 * qnorm( 0.25 ) )</code>;</li>
<li>
<code>F_min</code>: the minimum value of <code>Fvalue</code>, defining the left boundary for the optimization problem aimed at finding, for a given dataset of simulated gaussian data associated to Data, the optimal value of <code>Fvalue</code>. Default is <code>0.5</code>;</li>
<li>
<code>F_max</code>: the maximum value of <code>Fvalue</code>, defining the right boundary for the optimization problem aimed at finding, for a given dataset of simulated gaussian data associated to Data, the optimal value of <code>Fvalue</code>. Default is <code>5</code>;</li>
<li>
<code>tol</code>: the tolerance to be used in the optimization problem aimed at finding, for a given dataset of simulated gaussian data associated to Data, the optimal value of <code>Fvalue</code>. Default is <code>1e-3</code>;</li>
<li>
<code>maxiter</code>: the maximum number of iterations to solve the optimization problem aimed at finding, for a given dataset of simulated gaussian data associated to <code>Data</code>, the optimal value of <code>Fvalue</code>. Default is <code>100</code>;</li>
<li>
<code>VERBOSE</code>: a parameter controlling the verbosity of the adjustment process;</li>
</ul>
<p><em>Suggestion</em>: Try and select a sufficiently high value for <code>adjust$trial_size</code>, in fact too small values (the default is <code>8 * adjust$N</code>) will result in the impossibility to carry out the optimization since the TPR percentage is too small compared to the sample size.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="../reference/fbplot.html">fbplot</a></span><span class="op">(</span> <span class="va">fD</span>, adjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> N_trials <span class="op">=</span> <span class="fl">20</span>, trial_size <span class="op">=</span> <span class="va">N</span>, TPR <span class="op">=</span> <span class="fl">0.007</span>, F_min <span class="op">=</span> <span class="fl">0.1</span>, F_max <span class="op">=</span> <span class="fl">20</span> <span class="op">)</span>, xlab <span class="op">=</span> <span class="st">'grid'</span>, ylab <span class="op">=</span> <span class="st">'values'</span>, main <span class="op">=</span> <span class="st">'Adjusted functional boxplot'</span> <span class="op">)</span></code></pre></div>
<p><img src="roahd_files/figure-html/fbplot_fData_adjust-1.png" width="672" style="display: block; margin: auto;"></p>
<pre><code><span class="co">## $Depth</span>
<span class="co">##   [1] 0.38385859 0.49394343 0.34525657 0.42096162 0.13828283 0.35837576</span>
<span class="co">##   [7] 0.28715152 0.32094949 0.32032323 0.48111919 0.31599192 0.21463030</span>
<span class="co">##  [13] 0.50012525 0.42326869 0.48843232 0.20121616 0.50892929 0.47389091</span>
<span class="co">##  [19] 0.20728889 0.47252121 0.06370909 0.33557576 0.15535354 0.47672727</span>
<span class="co">##  [25] 0.47752323 0.42835152 0.46382222 0.22322020 0.47668687 0.35484848</span>
<span class="co">##  [31] 0.33292929 0.08008485 0.25306667 0.44199192 0.02651717 0.44075556</span>
<span class="co">##  [37] 0.47486869 0.15956768 0.29795556 0.29344242 0.29510303 0.16485657</span>
<span class="co">##  [43] 0.16455758 0.17609293 0.45211717 0.05358384 0.48465051 0.38964040</span>
<span class="co">##  [49] 0.21711515 0.33858990 0.19272727 0.47710707 0.34191515 0.40525657</span>
<span class="co">##  [55] 0.22770505 0.10705051 0.39230303 0.29587071 0.33210101 0.45514747</span>
<span class="co">##  [61] 0.49753939 0.49472727 0.44715152 0.36111515 0.33575354 0.22018586</span>
<span class="co">##  [67] 0.49524040 0.49006465 0.41932121 0.44806869 0.39192727 0.27018182</span>
<span class="co">##  [73] 0.48225051 0.46254141 0.27178182 0.40633131 0.40986263 0.09875152</span>
<span class="co">##  [79] 0.47945051 0.47055758 0.35553535 0.47608889 0.05703434 0.39505859</span>
<span class="co">##  [85] 0.18181010 0.12517172 0.43975758 0.30673535 0.47002020 0.44986263</span>
<span class="co">##  [91] 0.47310707 0.02000000 0.28471919 0.47399192 0.50324444 0.46288485</span>
<span class="co">##  [97] 0.38802424 0.36598788 0.41559596 0.49222626</span>
<span class="co">## </span>
<span class="co">## $Fvalue</span>
<span class="co">## [1] 1.399858</span>
<span class="co">## </span>
<span class="co">## $ID_outliers</span>
<span class="co">## [1] 46 92</span></code></pre>
</div>
<div class="section level3">
<h3 id="outliergram">Outliergram<a class="anchor" aria-label="anchor" href="#outliergram"></a>
</h3>
<p>A method that can be used to detect <strong>shape outliers</strong> is the outliergram <span class="citation">(see Arribas-Gil and Romo 2014)</span>, based on the computation of MBD and MEI of univariate functional data. Such pairs are compared to a limiting parabola, where they should be placed in case of non-crossing data, and outliers are then identified applying a thresholding rule.</p>
<p>The function <code>outliergram</code> displays the outliergram of a univariate functional dataset of class <code>fData</code>, and returns a vector of IDs indicating the shape outlying observations in the dataset.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span> <span class="fl">1618</span> <span class="op">)</span>

<span class="va">N</span> <span class="op">=</span> <span class="fl">100</span>
<span class="va">P</span> <span class="op">=</span> <span class="fl">200</span>
<span class="va">N_extra</span> <span class="op">=</span> <span class="fl">4</span>

<span class="va">grid</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="va">P</span> <span class="op">)</span>

<span class="va">Cov</span> <span class="op">=</span> <span class="fu"><a href="../reference/exp_cov_function.html">exp_cov_function</a></span><span class="op">(</span> <span class="va">grid</span>, alpha <span class="op">=</span> <span class="fl">0.2</span>, beta <span class="op">=</span> <span class="fl">0.5</span> <span class="op">)</span>

<span class="va">Data</span> <span class="op">=</span> <span class="fu"><a href="../reference/generate_gauss_fdata.html">generate_gauss_fdata</a></span><span class="op">(</span> <span class="va">N</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span> <span class="fl">4</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">grid</span> <span class="op">)</span>, <span class="va">Cov</span> <span class="op">)</span>

<span class="va">Data_extra</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span> <span class="fl">0</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="va">N_extra</span>, <span class="va">P</span> <span class="op">)</span> <span class="op">)</span>

<span class="va">Data_extra</span><span class="op">[</span> <span class="fl">1</span>, <span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="../reference/generate_gauss_fdata.html">generate_gauss_fdata</a></span><span class="op">(</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span> <span class="fl">4</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">grid</span> <span class="op">+</span> <span class="va">pi</span> <span class="op">/</span> <span class="fl">2</span> <span class="op">)</span>, <span class="va">Cov</span> <span class="op">)</span>

<span class="va">Data_extra</span><span class="op">[</span> <span class="fl">2</span>, <span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="../reference/generate_gauss_fdata.html">generate_gauss_fdata</a></span><span class="op">(</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span> <span class="fl">4</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">grid</span> <span class="op">-</span> <span class="va">pi</span> <span class="op">/</span> <span class="fl">2</span> <span class="op">)</span>, <span class="va">Cov</span> <span class="op">)</span>

<span class="va">Data_extra</span><span class="op">[</span> <span class="fl">3</span>, <span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="../reference/generate_gauss_fdata.html">generate_gauss_fdata</a></span><span class="op">(</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span> <span class="fl">4</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">grid</span> <span class="op">+</span> <span class="va">pi</span><span class="op">/</span> <span class="fl">3</span> <span class="op">)</span>, <span class="va">Cov</span> <span class="op">)</span>

<span class="va">Data_extra</span><span class="op">[</span> <span class="fl">4</span>, <span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="../reference/generate_gauss_fdata.html">generate_gauss_fdata</a></span><span class="op">(</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span> <span class="fl">4</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">grid</span> <span class="op">-</span> <span class="va">pi</span> <span class="op">/</span> <span class="fl">3</span><span class="op">)</span>, <span class="va">Cov</span> <span class="op">)</span>

<span class="va">fD</span> <span class="op">=</span> <span class="fu"><a href="../reference/fData.html">fData</a></span><span class="op">(</span> <span class="va">grid</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span> <span class="va">Data</span>, <span class="va">Data_extra</span> <span class="op">)</span> <span class="op">)</span>

<span class="fu"><a href="../reference/outliergram.html">outliergram</a></span><span class="op">(</span> <span class="va">fD</span>, display <span class="op">=</span> <span class="cn">TRUE</span> <span class="op">)</span></code></pre></div>
<p><img src="roahd_files/figure-html/outliergram-1.png" width="672" style="display: block; margin: auto;"></p>
<pre><code><span class="co">## $Fvalue</span>
<span class="co">## [1] 1.5</span>
<span class="co">## </span>
<span class="co">## $d</span>
<span class="co">##   [1] 0.0265397638 0.0420972694 0.0163513770 0.0111532440 0.0067863658</span>
<span class="co">##   [6] 0.0633575009 0.0304361417 0.0057970454 0.0227571882 0.0145653426</span>
<span class="co">##  [11] 0.0258463359 0.0060416309 0.0229304705 0.0184764330 0.0331577623</span>
<span class="co">##  [16] 0.0375485017 0.0080973441 0.0332893531 0.0049783374 0.0287247946</span>
<span class="co">##  [21] 0.0007439834 0.0179507842 0.0048674384 0.0205908094 0.0507057459</span>
<span class="co">##  [26] 0.0140847461 0.0598439087 0.0053677698 0.0091204957 0.0585340553</span>
<span class="co">##  [31] 0.0383932739 0.0004547423 0.0245676578 0.0225522778 0.0001640030</span>
<span class="co">##  [36] 0.0137137976 0.0249363284 0.0082996593 0.0171567914 0.0067567401</span>
<span class="co">##  [41] 0.0639066281 0.0024988611 0.0093970827 0.0181396378 0.0148128267</span>
<span class="co">##  [46] 0.0009838265 0.0250156413 0.0060619119 0.0059523478 0.0127617205</span>
<span class="co">##  [51] 0.0037292709 0.0344801904 0.0295149319 0.0203452903 0.0059721761</span>
<span class="co">##  [56] 0.2026008028 0.0077727362 0.0117117065 0.0247040282 0.0152389843</span>
<span class="co">##  [61] 0.0188668969 0.0209339012 0.0330268437 0.0180122479 0.0270653286</span>
<span class="co">##  [66] 0.0296787901 0.0298717513 0.0207407580 0.0166910941 0.0320567541</span>
<span class="co">##  [71] 0.0130978155 0.0144047610 0.0436259149 0.1107886436 0.0129862537</span>
<span class="co">##  [76] 0.0281796117 0.0295481283 0.0499512883 0.0360432972 0.0281692261</span>
<span class="co">##  [81] 0.0093940207 0.0328179798 0.0005894277 0.0103774459 0.0032465273</span>
<span class="co">##  [86] 0.0116910194 0.0229937220 0.0093602689 0.0059032114 0.0528054472</span>
<span class="co">##  [91] 0.0502566047 0.0002764003 0.0057026886 0.0281358476 0.0125306152</span>
<span class="co">##  [96] 0.0088838499 0.0331520538 0.0125406087 0.0514152353 0.0174583831</span>
<span class="co">## [101] 0.3399725121 0.3680126774 0.2770713966 0.2794677698</span>
<span class="co">## </span>
<span class="co">## $ID_outliers</span>
<span class="co">## [1]  56  74 101 102 103 104</span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/outliergram.html">outliergram</a></span><span class="op">(</span> <span class="va">fD</span>, Fvalue <span class="op">=</span> <span class="fl">5</span>, display <span class="op">=</span> <span class="cn">TRUE</span> <span class="op">)</span></code></pre></div>
<p><img src="roahd_files/figure-html/outliergram-2.png" width="672" style="display: block; margin: auto;"></p>
<pre><code><span class="co">## $Fvalue</span>
<span class="co">## [1] 5</span>
<span class="co">## </span>
<span class="co">## $d</span>
<span class="co">##   [1] 0.0265397638 0.0420972694 0.0163513770 0.0111532440 0.0067863658</span>
<span class="co">##   [6] 0.0633575009 0.0304361417 0.0057970454 0.0227571882 0.0145653426</span>
<span class="co">##  [11] 0.0258463359 0.0060416309 0.0229304705 0.0184764330 0.0331577623</span>
<span class="co">##  [16] 0.0375485017 0.0080973441 0.0332893531 0.0049783374 0.0287247946</span>
<span class="co">##  [21] 0.0007439834 0.0179507842 0.0048674384 0.0205908094 0.0507057459</span>
<span class="co">##  [26] 0.0140847461 0.0598439087 0.0053677698 0.0091204957 0.0585340553</span>
<span class="co">##  [31] 0.0383932739 0.0004547423 0.0245676578 0.0225522778 0.0001640030</span>
<span class="co">##  [36] 0.0137137976 0.0249363284 0.0082996593 0.0171567914 0.0067567401</span>
<span class="co">##  [41] 0.0639066281 0.0024988611 0.0093970827 0.0181396378 0.0148128267</span>
<span class="co">##  [46] 0.0009838265 0.0250156413 0.0060619119 0.0059523478 0.0127617205</span>
<span class="co">##  [51] 0.0037292709 0.0344801904 0.0295149319 0.0203452903 0.0059721761</span>
<span class="co">##  [56] 0.2026008028 0.0077727362 0.0117117065 0.0247040282 0.0152389843</span>
<span class="co">##  [61] 0.0188668969 0.0209339012 0.0330268437 0.0180122479 0.0270653286</span>
<span class="co">##  [66] 0.0296787901 0.0298717513 0.0207407580 0.0166910941 0.0320567541</span>
<span class="co">##  [71] 0.0130978155 0.0144047610 0.0436259149 0.1107886436 0.0129862537</span>
<span class="co">##  [76] 0.0281796117 0.0295481283 0.0499512883 0.0360432972 0.0281692261</span>
<span class="co">##  [81] 0.0093940207 0.0328179798 0.0005894277 0.0103774459 0.0032465273</span>
<span class="co">##  [86] 0.0116910194 0.0229937220 0.0093602689 0.0059032114 0.0528054472</span>
<span class="co">##  [91] 0.0502566047 0.0002764003 0.0057026886 0.0281358476 0.0125306152</span>
<span class="co">##  [96] 0.0088838499 0.0331520538 0.0125406087 0.0514152353 0.0174583831</span>
<span class="co">## [101] 0.3399725121 0.3680126774 0.2770713966 0.2794677698</span>
<span class="co">## </span>
<span class="co">## $ID_outliers</span>
<span class="co">## [1]  56 101 102 103 104</span></code></pre>
<p>Similarly to the functional boxplot, also the outliergram makes use of an <code>Fvalue</code> constant controlling the check by which observations are flagged as outliers <span class="citation">(see Arribas-Gil and Romo 2014 for more details)</span>. Such value can be provided as an argument (default is <code>1.5</code>), or can be determined by the function itself, through an adjustment procedure similar to that of <code>fbplot.fData</code>. In particular, whenever <code>adjust</code> is not <code>FALSE</code>, <code>adjust</code> should be a list containing the fields controlling the adjustment:</p>
<ul>
<li>
<code>N_trials</code> the number of repetitions of the adjustment procedure based on the simulation of a gaussian population of functional data, each one producing an adjusted value of <code>Fvalue</code>, which will lead to the averaged adjusted value. Default is <code>20</code>;</li>
<li>
<code>trial_size</code> the number of elements in the gaussian population of functional data that will be simulated at each repetition of the adjustment procedure. Default is <code>5 * fData$N</code>;</li>
<li>
<code>TPR</code> the True Positive Rate of outliers, i.e. the proportion of observations in a dataset without shape outliers that have to be considered outliers. Default is <code>2 * pnorm( 4 * qnorm( 0.25 ) )</code>;</li>
<li>
<code>F_min</code> the minimum value of <code>Fvalue</code>, defining the left boundary for the optimization problem aimed at finding, for a given dataset of simulated gaussian data associated to <code>fData</code>, the optimal value of <code>Fvalue</code>. Default is <code>0.5</code>;</li>
<li>
<code>F_max</code> the maximum value of <code>Fvalue</code>, defining the right boundary for the optimization problem aimed at finding, for a given dataset of simulated gaussian data associated to <code>fData</code>, the optimal value of <code>Fvalue</code>. Default is <code>20</code>;}</li>
<li>
<code>tol</code> the tolerance to be used in the optimization problem aimed at finding, for a given dataset of simulated gaussian data associated to <code>fData</code>, the optimal value of <code>Fvalue</code>. Default is <code>1e-3</code>;</li>
<li>
<code>maxiter</code> the maximum number of iterations to solve the optimization problem aimed at finding, for a given dataset of simulated gaussian data associated to <code>fData</code>, the optimal value of <code>Fvalue</code>. Default is <code>100</code>;</li>
<li>
<code>VERBOSE</code> a parameter controlling the verbosity of the adjustment process;</li>
</ul>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/outliergram.html">outliergram</a></span><span class="op">(</span> <span class="va">fD</span>, adjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> N_trials <span class="op">=</span> <span class="fl">5</span>, trial_size <span class="op">=</span> <span class="fl">5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span> <span class="va">Data</span> <span class="op">)</span>, TPR <span class="op">=</span> <span class="fl">0.01</span>, VERBOSE <span class="op">=</span> <span class="cn">FALSE</span> <span class="op">)</span>, display <span class="op">=</span> <span class="cn">TRUE</span> <span class="op">)</span></code></pre></div>
<p><img src="roahd_files/figure-html/outliergram_adjusted-1.png" width="672"></p>
<pre><code><span class="co">## $Fvalue</span>
<span class="co">## [1] 2.677161</span>
<span class="co">## </span>
<span class="co">## $d</span>
<span class="co">##   [1] 0.0265397638 0.0420972694 0.0163513770 0.0111532440 0.0067863658</span>
<span class="co">##   [6] 0.0633575009 0.0304361417 0.0057970454 0.0227571882 0.0145653426</span>
<span class="co">##  [11] 0.0258463359 0.0060416309 0.0229304705 0.0184764330 0.0331577623</span>
<span class="co">##  [16] 0.0375485017 0.0080973441 0.0332893531 0.0049783374 0.0287247946</span>
<span class="co">##  [21] 0.0007439834 0.0179507842 0.0048674384 0.0205908094 0.0507057459</span>
<span class="co">##  [26] 0.0140847461 0.0598439087 0.0053677698 0.0091204957 0.0585340553</span>
<span class="co">##  [31] 0.0383932739 0.0004547423 0.0245676578 0.0225522778 0.0001640030</span>
<span class="co">##  [36] 0.0137137976 0.0249363284 0.0082996593 0.0171567914 0.0067567401</span>
<span class="co">##  [41] 0.0639066281 0.0024988611 0.0093970827 0.0181396378 0.0148128267</span>
<span class="co">##  [46] 0.0009838265 0.0250156413 0.0060619119 0.0059523478 0.0127617205</span>
<span class="co">##  [51] 0.0037292709 0.0344801904 0.0295149319 0.0203452903 0.0059721761</span>
<span class="co">##  [56] 0.2026008028 0.0077727362 0.0117117065 0.0247040282 0.0152389843</span>
<span class="co">##  [61] 0.0188668969 0.0209339012 0.0330268437 0.0180122479 0.0270653286</span>
<span class="co">##  [66] 0.0296787901 0.0298717513 0.0207407580 0.0166910941 0.0320567541</span>
<span class="co">##  [71] 0.0130978155 0.0144047610 0.0436259149 0.1107886436 0.0129862537</span>
<span class="co">##  [76] 0.0281796117 0.0295481283 0.0499512883 0.0360432972 0.0281692261</span>
<span class="co">##  [81] 0.0093940207 0.0328179798 0.0005894277 0.0103774459 0.0032465273</span>
<span class="co">##  [86] 0.0116910194 0.0229937220 0.0093602689 0.0059032114 0.0528054472</span>
<span class="co">##  [91] 0.0502566047 0.0002764003 0.0057026886 0.0281358476 0.0125306152</span>
<span class="co">##  [96] 0.0088838499 0.0331520538 0.0125406087 0.0514152353 0.0174583831</span>
<span class="co">## [101] 0.3399725121 0.3680126774 0.2770713966 0.2794677698</span>
<span class="co">## </span>
<span class="co">## $ID_outliers</span>
<span class="co">## [1]  56  74 101 102 103 104</span></code></pre>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-arribasgil_romo_2014" class="csl-entry">
Arribas-Gil, A., and J. Romo. 2014. <span>“Shape Outlier Detection and Visualization for Functional Data: The Outliergram.”</span> <em>Biostatistics</em> 15 (4): 603–19.
</div>
<div id="ref-ieva_paganoni_2013" class="csl-entry">
Ieva, F., and A. M. Paganoni. 2013. <span>“Depth Measures for Multivariate Functional Data.”</span> <em>Communication in Statistics - Theory and Methods</em> 42 (7): 1265–76.
</div>
<div id="ref-Ieva2019" class="csl-entry">
Ieva, Francesca, Anna Maria Paganoni, Juan Romo, and Nicholas Tarabelloni. 2019. <span>“<span class="nocase">roahd Package: Robust Analysis of High Dimensional Data</span>.”</span> <em><span>The R Journal</span></em> 11 (2): 291–307. <a href="https://doi.org/10.32614/RJ-2019-032" class="external-link">https://doi.org/10.32614/RJ-2019-032</a>.
</div>
<div id="ref-lopezpintado_romo_2007" class="csl-entry">
López-Pintado, S., and J. Romo. 2007. <span>“Depth-Based Inference for Functional Data.”</span> <em>Computational Statistics &amp; Data Analysis</em> 51 (10): 4957–68.
</div>
<div id="ref-lopezpintado_romo_2009" class="csl-entry">
———. 2009. <span>“On the Concept of Depth for Functional Data.”</span> <em>Journal of the American Statistical Association</em> 104 (486): 718–34.
</div>
<div id="ref-lopezpintado_romo_2011" class="csl-entry">
———. 2011. <span>“A Half-Region Depth for Functional Data.”</span> <em>Computational Statistics &amp; Data Analysis</em> 55 (4): 1679–95.
</div>
<div id="ref-Sun_Genton_2011" class="csl-entry">
Sun, Y., and M. G. Genton. 2011. <span>“Functional Boxplots.”</span> <em>Journal of Computational and Graphical Statistics</em> 20 (2): 316–34.
</div>
<div id="ref-Sun_Genton_2012_boxplot" class="csl-entry">
———. 2012. <span>“Adjusted Functional Boxplots for Spatio-Temporal Data Visualization and Outlier Detection.”</span> <em>Environmetrics</em> 23 (1): 54–64.
</div>
<div id="ref-Sun_Genton_2012" class="csl-entry">
Sun, Y., M. G. Genton, and D. W. Nychka. 2012. <span>“Exact Fast Computation of Band Depth for Large Functional Datasets: How Quickly Can One Million Curves Be Ranked?”</span> <em>Stat</em> 1 (1): 68–74.
</div>
<div id="ref-tarabelloni_ieva_etal_2015" class="csl-entry">
Tarabelloni, N., F. Ieva, R. Biasi, and A. M. Paganoni. 2015. <span>“Use of Depth Measure for Multivariate Functional Data in Disease Prediction: An Application to Electrocardiograph Signals.”</span> <em>The International Journal of Biostatistics</em> 11 (2): 189–201.
</div>
<div id="ref-kendall_2015" class="csl-entry">
Valencia, D., J. Romo, and R. Lillo. 2015a. <span>“A Kendall Correlation Coefficient for Functional Dependence.”</span> http://EconPapers.repec.org/RePEc:cte:wsrepe:ws133228: Universidad Carlos III de Madrid.
</div>
<div id="ref-spearman_2015" class="csl-entry">
———. 2015b. <span>“Spearman Coefficient for Functions.”</span> http://EconPapers.repec.org/RePEc:cte:wsrepe:ws133329: Universidad Carlos III de Madrid.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Nicholas Tarabelloni, Ana Arribas-Gil, Francesca Ieva, Anna Maria Paganoni, Juan Romo, Aymeric Stamm.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
